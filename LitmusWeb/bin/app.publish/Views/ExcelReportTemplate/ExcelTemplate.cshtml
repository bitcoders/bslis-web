@model IEnumerable<LitmusWeb.Models.ExcelReportTemplateModel>
@{
    ViewBag.Title = "ExcelTemplate";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/MainContent/vendors/select2/select2.min.css" rel="stylesheet" />
<link href="~/Content/MainContent/vendors/select2-bootstrap-theme/select2-bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/MainContent/vendors/jquery-toast-plugin/jquery.toast.min.css" rel="stylesheet" />
<div class="main-panel">
    <div class="content-wrapper">
        <div class="row">
            <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <div class="card-body dashboard-tabs p-0">
                            <div class="tab-content py-0 px-0 border-left-0 border-bottom-0 border-right-0">
                                <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
                                    <div class="d-flex flex-wrap justify-content-xl-between">
                                        @using (Html.BeginForm("Add", "ExcelTemplate", FormMethod.Post, htmlAttributes: new { @class = "form-inline" }))
                                        {
                                            @Html.AntiForgeryToken();
                                                    //int reportCode = Model.Select(@x => x.ReportDetails_ReportCode).FirstOrDefault();
                                                    int reportCode = ViewBag.WorkingReportCode;
                                                    int reportSchemaCode = ViewBag.reportSchemaCode;
                                            <input type="hidden" value="@reportCode" id="workingReportCode" />
                                            <input type="hidden" id="reportSchemaCode" value="@reportSchemaCode" />
                                            <div class="input-group mb-2 mr-sm-2">
                                                <input type="number" class="form-control" name="DataType" id="DataType" placeholder="Data Type Code" />
                                            </div>
                                            <div class="input-group mb-2 mr-sm-2">

                                                <input type="text" class="form-control" name="CellFrom" id="CellFrom" placeholder="Excel Cell From" />
                                            </div>
                                            <div class="input-group mb-2 mr-sm-2">
                                                <input type="text" class="form-control" name="CellTo" id="CellTo" placeholder="Excel Cell To" />
                                            </div>
                                            <div class="input-group mb-2 mr-sm-2" id="the-basics">
                                                <input type="text" class="form-control typeahead" name="Value" id="Value" placeholder="Value" />
                                            </div>
                                            <div class="form-check mx-sm-2">
                                                <label class="form-check-label">
                                                    <input type="checkbox" class="form-check-input" id="Bold" name="Bold" />Bold
                                                </label>
                                            </div>
                                            <div class="form-check mx-sm-2">
                                                <label class="form-check-label">
                                                    <input type="checkbox" class="form-check-input" id="Italic" name="Italic" />Italic
                                                </label>
                                            </div>
                                            <div class="input-group mb-2 mr-sm-2 btnContainer">
                                                <button type="button" id="btnSave" name="btnSave" class="btn btn-sm btn-inverse-success" onclick="addNewItem(@reportCode);">Save</button>
                                            </div>

                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Display existing Items in report-->
        <div class="row">
            <div class="col-12 grid-margin">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">
                            Excel Report Template.<code> @Model.Select(x => x.ReportName).FirstOrDefault()</code>
                            @*@Html.ActionLink("Add", "Create", new { }, new { @class = "btn btn-sm btn-inverse-success float-right", title = "Add new custom data type." })*@
                        </h4>
                        <div id="js-grid-sortable"></div>
                        <table class="table table-bordered display nowrap" id="AnalysisDataTable-Scrollable">
                            <thead class="text-lg-center">
                                <tr>
                                    <th>Action</th>
                                    <th>Id </th>
                                    <th>Data Type</th>
                                    <th>Cell From</th>
                                    <th>Cell To</th>
                                    <th>Value</th>
                                    <th>Bold</th>
                                    <th>Italic</th>
                                    <th>Font Color</th>
                                    <th>Background Color</th>
                                    <th>Number Format</th>
                                    <th>Help Text</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <td><input type="button" class="btn btn-sm btn-inverse-warning" name="btnEdit" id="btnEdit" value="Edit" onclick="getDetailsOfSelectedItem(@item.Id)" /></td>
                                        <td class="text-center">@Html.DisplayFor(x => @item.Id)</td>
                                        <td>@Html.DisplayFor(x => @item.DataTypeName)</td>
                                        <td>@Html.DisplayFor(x => @item.CellFrom)</td>
                                        <td>@Html.DisplayFor(x => @item.CellTo)</td>
                                        <td>@Html.DisplayFor(x => @item.Value)</td>
                                        <td>@Html.DisplayFor(x => @item.Bold)</td>
                                        <td>@Html.DisplayFor(x => @item.Italic)</td>
                                        <td>@Html.DisplayFor(x => @item.FontColor)</td>
                                        <td>@Html.DisplayFor(x => @item.BackGroundColor)</td>
                                        <td>@Html.DisplayFor(x => @item.NumerFormat)</td>
                                        <td>@Html.DisplayFor(x => @item.HelpText)</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- scripts to show pop-up message-->
    <script src="~/Content/MainContent/vendors/jquery-toast-plugin/jquery.toast.min.js"></script>
    <script src="~/Scripts/js/toastDemo.js" type="text/javascript"></script>
    <!-- scripts to show pop-up message Ends Here-->

    <script src="~/Content/MainContent/vendors/typeahead.js/typeahead.bundle.min.js"></script>
    <script src="~/Content/MainContent/vendors/select2/select2.min.js"></script>
    <script src="~/Scripts/js/select2.js"></script>
    <script src="~/Scripts/Ajax/ExcelReportTempate-1.2.js"></script>






